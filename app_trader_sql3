App store list
with lifespan as (SELECT DISTINCT(name), (rating * 2)+1 AS expected_lifespan
				  FROM app_store_apps)
SELECT DISTINCT(name), expected_lifespan, price, review_count::numeric, primary_genre,
       CASE WHEN price BETWEEN 0 AND 1 THEN '10000'
			WHEN price > 1 THEN price * 10000 END AS cost_Purchase
FROM app_store_apps INNER JOIN lifespan USING (name)
WHERE rating IS NOT NULL AND review_count IS NOT NULL
AND price <= 1
ORDER BY expected_lifespan DESC, review_count DESC
LIMIT 10;
Play store list
with lifespan as (SELECT DISTINCT(name), (rating * 2)+1 AS expected_lifespan
				  FROM play_store_apps)
SELECT DISTINCT(name), rating, category, review_count, expected_lifespan
FROM play_store_apps INNER JOIN lifespan USING (name)
WHERE rating > 4.7
AND rating IS NOT NULL AND review_count IS NOT NULL
AND price IN ('0', '$0.99', '$1.00')
AND category IN ('GAME', 'FAMILY')
ORDER BY review_count DESC, expected_lifespan DESC
LIMIT 12;
In both list
WITH in_both AS (SELECT DISTINCT(name)
			 FROM app_store_apps INNER JOIN play_store_apps USING (name))
			
SELECT DISTINCT(name), (rating * 2)+1 AS expected_lifespan, price, review_count::numeric, primary_genre,
       CASE WHEN price BETWEEN 0 AND 1 THEN '10000'
			WHEN price > 1 THEN price * 10000 END AS cost_Purchase
FROM app_store_apps INNER JOIN in_both USING (name)
WHERE rating IS NOT NULL AND review_count IS NOT NULL
AND price <= 1
ORDER BY expected_lifespan DESC, review_count DESC
LIMIT 15;